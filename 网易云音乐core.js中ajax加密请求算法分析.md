### 说明

本项目分析了网易云音乐core.js中ajax请求的加密过程。运用Fiddler进行了javascript调试，分析了加密过程，并且用python 3.5 以及PyCrypto库和requests库，进行了模拟请求。



### 网易云音乐core.js中ajax加密请求算法分析

1. 用chrome开发者工具查看ajax查询请求，发现是post请求，其请求参数为params和encSecKey，均进行了加密处理。

2. 下载core.js文件，用Fiddler工具进行处理，得出请求params的原始明文结构。以及加密方法。

3. 对于params的加密，利用了Crypto.js库中的AES加密方法，进行了两次加密。第一次是采用了固定加密密钥进行加密，第二次是将第一次加密得到的结果利用随机生成的16位参数进行二次AES加密。encSecKey是对AES算法中的16位随机生成参数进行RSA加密的结果。利用的是OHDave写的RSA加密库(该库1998年诞生)。

4. 分析Crypto.js中AES加密过程，其padding算法采用的是PKCS#7的补位方式。即明文长度补全为16的整数倍。补全参数为padding长度*chr(padding长度)。返回的加密结果都需要进行base64编码。

5. 分析OHDave写的RSA加密库。它支持三种padding方式。

   ① 明文在拆分成块时，后面不足的全部补0。(该方法如果不转换成二进制块，相当于放大了原明文转换的16进制整数，直接用书本方法进行加密运算，速度更慢。而且补0的个数未知，需要计算)

   ② 明文在拆分成块时，明文先进行倒序，然后在前面补0，相当于①方法倒过来。(该方法实现起来简单，可以直接将明文转换成16进制大整数m，由于在前面补0，并不增加大整数的大小。以及将publickey和module字符串转换成16进制整数，利用书本中的基本加密公式:m^publickey mod module直接得到加密后的整数，最后将加密后的整数再进行16进制编码，即可得到密文。由于没有采用二进制分块运算，计算速度不快)

   ③ 采用PKCS1_5的pad方法。(该方法如果不采用二进制块运算，实现起来困难。采用PyCrypto库，利用construct方法生成rsa对象，利用PyCrpto自带的PKCS1_5 RSA方法加密，发送给服务器时，无法得到返回结果。服务器可能无法对其进行RSA解密。由于PyCrypto为了计算速度，其中加密具体过程是已经进行了编译的pyx文件，无法直接分析过程。所以该方法难以使用。)

